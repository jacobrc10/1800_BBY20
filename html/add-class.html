<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Know-It-All Notifier - Add Course</title>
    <meta name="comp1800 boilerplate code" content="my bcit project" />
    <meta name="author" content="BCIT" />
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <!-- Google Icons (Material Design)-->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <!-- My CSS Stylesheet-->
    <link rel="stylesheet" href="/styles/my_style.css" />

    <!-- Firebase 8 CDNs-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <!-- Link to api keys for Firebase project -->
    <script src="/scripts/firebaseAPI_BBY20.js"></script>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container-fluid">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="#">Add Course</a>
        <button
          class="material-icons md-light md-36"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasRight"
          aria-controls="offcanvasRight"
        >
          account_circle
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="main.html"
                >Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="calendar.html">Calendar</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="to-do.html">To-Do List</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="links.html">Class Links</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="chat.html" tabindex="-1">Chat</a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="mocktest.html"
                tabindex="-1"
                aria-disabled="true"
                >Mock Test
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="help.html"
                tabindex="-1"
                aria-disabled="true"
                >Help
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <br />

    <div
      class="offcanvas offcanvas-end"
      tabindex="-1"
      id="offcanvasRight"
      aria-labelledby="offcanvasRightLabel"
    >
      <div class="offcanvas-header">
        <img id="accountimg" src="/images/account.png" />
        <button
          type="button"
          class="btn-close text-reset"
          data-bs-dismiss="offcanvas"
          aria-label="Close"
        ></button>
      </div>
      <div class="offcanvas-body">
        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            <b class="list-group-item-heading">Profile Name</b>
          </li>
          <a href="#" class="list-group-item" id="profilename">John Doe</a>
        </ul>

        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            <b class="list-group-item-heading">Classes</b>
          </li>
          <a href="#" class="list-group-item list-group-item-action"
            >COMP 1800</a
          >
          <a href="#" class="list-group-item list-group-item-action"
            >COMM 1116</a
          >
          <a href="#" class="list-group-item list-group-item-action"
            >COMP 1537</a
          >
          <li class="list-group-item list-group-item-action">
            <i class="material-icons md-14">add</i>
            <a href="add-class.html">Add another course</a>
          </li>
        </ul>

        <br />
        <ul class="list-group list-group-flush">
          <a href="profile.html" class="list-group-item list-group-item-action"
            >My Account</a
          >
          <a href="#" class="list-group-item list-group-item-action"
            >Connections</a
          >
          <a href="settings.html" class="list-group-item list-group-item-action"
            >App Settings</a
          >
        </ul>

        <div class="logout">
          <button
            type="button"
            class="btn btn-outline-info"
            onclick="location.href='login.html';"
          >
            <i class="material-icons md-14">logout</i>
            Log Out
          </button>
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="col-md-7 col-lg-8">
        <form>
          <div class="row g-3">
            <div class="col-sm-6">
              <label class="form-label">Class Name</label>
              <input
                type="text"
                class="form-control"
                id="className"
                placeholder="COMP 1234"
                value=""
                required=""
              />
              <div class="invalid-feedback">Valid name is required.</div>
            </div>

            <div class="col-sm-6">
              <label class="form-label">Class Link</label>
              <input
                type="text"
                class="form-control"
                id="classLink"
                placeholder="www.zwoosh.ca/room12e3432w2123?valid"
                value=""
                required=""
              />
              <div class="invalid-feedback">Valid link is required.</div>
            </div>

            <div class="col-sm-6">
              <div class="col-md-5">
                <label class="form-label">Lecture Delivery</label>
                <select class="form-select" id="lectureStat" required="">
                  <option value="">Choose...</option>
                  <option>In-Person</option>
                  <option>Online</option>
                  <option>Mixed</option>
                </select>
                <div class="invalid-feedback">
                  Please select a valid delivery system.
                </div>
              </div>
              <div class="col-md-5">
                <label class="form-label">Lab Delivery</label>
                <select class="form-select" id="labStat" required="">
                  <option value="">Choose...</option>
                  <option>In-Person</option>
                  <option>Online</option>
                  <option>Mixed</option>
                </select>
                <div class="invalid-feedback">
                  Please select a valid delivery system.
                </div>
              </div>
              <div class="col-md-5">
                <label class="form-label">Course colour</label>
                <!-- <select class="form-select" id="color" required="">
                  <option value="">Choose...</option>
                  <option class ="bg-primary">Blue</option>
                  <option class ="bg-success">Green</option>
                  <option class ="bg-danger">Red</option>
                  <option class ="bg-warning">Yellow</option>
                  <option class ="bg-info">Cyan</option>
                </select> -->
                <br />
                <div class="btn-group-vertical" id="colours">
                  <input
                    type="radio"
                    class="btn-check"
                    name="btncolour"
                    id="btnBlue"
                    autocomplete="off"
                    checked
                  />
                  <label class="btn btn-outline-primary" for="btnBlue"
                    >Blue</label
                  >

                  <input
                    type="radio"
                    class="btn-check"
                    name="btncolour"
                    id="btnGreen"
                    autocomplete="off"
                  />
                  <label class="btn btn-outline-success" for="btnGreen"
                    >Green</label
                  >

                  <input
                    type="radio"
                    class="btn-check"
                    name="btncolour"
                    id="btnRed"
                    autocomplete="off"
                  />
                  <label class="btn btn-outline-danger" for="btnRed">Red</label>

                  <input
                    type="radio"
                    class="btn-check"
                    name="btncolour"
                    id="btnYellow"
                    autocomplete="off"
                  />
                  <label class="btn btn-outline-warning" for="btnYellow"
                    >Yellow</label
                  >

                  <input
                    type="radio"
                    class="btn-check"
                    name="btncolour"
                    id="btnCyan"
                    autocomplete="off"
                  />
                  <label class="btn btn-outline-info" for="btnCyan">Cyan</label>
                </div>
                <div class="invalid-feedback">
                  Please select a valid delivery system.
                </div>
              </div>
            </div>

            <br />

            <div class="end">
              <button
                class="btn btn-primary end-0"
                type="button"
                onclick="classCreate()"
              >
                Confirm
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <br /><br /><br /><br /><br />

    <footer class="navbar justify-content-evenly bg-primary fixed-bottom">
      <div class="container py-3" id="footer">
        <a class="material-icons md-light" href="main.html">home</a>
        <a class="material-icons md-light md-36" href="add-event.html"
          >add_circle_outline</a
        >
        <a class="material-icons md-light" href="calendar.html">event</a>
      </div>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <!-- Javascript -->
    <script>
      var lectureStatus = "off";
      var labStatus = "on";

      function insertName() {
        firebase.auth().onAuthStateChanged((user) => {
          // Check if user is signed in:
          if (user) {
            // Do something for the current logged-in user here:
            console.log(user.uid);
            //go to the correct user document by referencing to the user uid
            currentUser = db.collection("users").doc(user.uid);
            //get the document for current user.
            currentUser.get().then((userDoc) => {
              var user_Name = userDoc.data().name;
              console.log(user_Name);
              document.getElementById("profilename").innerText = user_Name;
            });
          } else {
            // No user is signed in.
          }
        });
      }
      insertName();

      function classCreate() {
        let nameToAdd = document.getElementById("className").value;
        let linkToAdd = document.getElementById("classLink").value;
        let lectureStatus = document.getElementById("lectureStat").value;
        let labStatus = document.getElementById("labStat").value;

        var colours = document.getElementsByName("btncolour");
        var selectedColour;

        for (var i = 0; i < colours.length; i++) {
          if (colours[i].checked) {
            if (i == 0) {
              selectedColour = "blue";
            } else if (i == 1) {
              selectedColour = "green";
            } else if (i == 2) {
              selectedColour = "red";
            } else if (i == 3) {
              selectedColour = "yellow";
            } else if (i == 4) {
              selectedColour = "cyan";
            }
          }
        }

        console.log(nameToAdd);
        console.log(linkToAdd);
        console.log(lectureStatus);
        console.log(labStatus);
        console.log(selectedColour);

        firebase.auth().onAuthStateChanged((user) => {
          if (user) {
            // User is signed in, see docs for a list of available properties
            // https://firebase.google.com/docs/reference/js/firebase.User

            currentUser = db
              .collection("users")
              .doc(user.uid)
              .collection("courses");

            currentUser.get().then((userDoc) => {
              currentUser.add({
                name: nameToAdd,
                link: linkToAdd,
                lectureDelivery: lectureStatus,
                labDelivery: labStatus,
                color: selectedColour,
              });
            });
          } else {
            // User is signed out
            console.log("No user is signed in");
          }
        });
      }
    </script>
  </body>
</html>
